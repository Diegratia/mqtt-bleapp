<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Proyeksi Tag ke Garis Gateway</title>
    <style>
      canvas {
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <h2>Proyeksi Posisi Tag ke Garis Gateway</h2>
    <canvas id="canvas" width="600" height="600"></canvas>

    <script>
      // Data posisi gateway dalam pixel
      const pos_px_x1 = 100;
      const pos_px_y1 = 100;
      const pos_px_x2 = 400;
      const pos_px_y2 = 300;

      // Skala konversi meter ke pixel
      const scaleMeterToPixel = 10;

      // Hitung vektor garis antara gateway
      const delta_x = pos_px_x2 - pos_px_x1;
      const delta_y = pos_px_y2 - pos_px_y1;

      // Posisi awal acak (contoh)
      const posisiAwal = { x: 200, y: 20 };

      // Fungsi gambar
      function draw() {
        const ctx = document.getElementById("canvas").getContext("2d");
        ctx.clearRect(0, 0, 600, 600);

        // Gambar gateway 1 dan 2
        ctx.fillStyle = "blue";
        ctx.beginPath();
        ctx.arc(pos_px_x1, pos_px_y1, 6, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText("Gateway 1", pos_px_x1 + 8, pos_px_y1);

        ctx.beginPath();
        ctx.arc(pos_px_x2, pos_px_y2, 6, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText("Gateway 2", pos_px_x2 + 8, pos_px_y2);

        // Garis antara gateway (biru)
        ctx.strokeStyle = "blue";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(pos_px_x1, pos_px_y1);
        ctx.lineTo(pos_px_x2, pos_px_y2);
        ctx.stroke();

        // Posisi awal acak (orange)
        ctx.fillStyle = "orange";
        ctx.beginPath();
        ctx.arc(posisiAwal.x, posisiAwal.y, 6, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText("Awal Acak", posisiAwal.x + 8, posisiAwal.y);

        // Hitung proyeksi posisi awal ke garis antara gateway
        const G = { x: pos_px_x1, y: pos_px_y1 };
        const G2 = { x: pos_px_x2, y: pos_px_y2 };

        const vx = G2.x - G.x;
        const vy = G2.y - G.y;

        const px = posisiAwal.x - G.x;
        const py = posisiAwal.y - G.y;

        const dot = px * vx + py * vy;
        const lenSq = vx * vx + vy * vy;
        const t = dot / lenSq;

        const projX = G.x + t * vx;
        const projY = G.y + t * vy;

        // Posisi akhir setelah proyeksi (menempel di garis)
        ctx.fillStyle = "purple";
        ctx.beginPath();
        ctx.arc(projX, projY, 6, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText("Menempel di Garis", projX + 8, projY);

        // Garis dari posisi tag ke garis (tegak lurus dari tag ke garis)
        ctx.strokeStyle = "red";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(posisiAwal.x, posisiAwal.y);
        ctx.lineTo(projX, projY);
        ctx.stroke();
      }

      // Panggil fungsi gambar
      draw();
    </script>
  </body>
</html>
